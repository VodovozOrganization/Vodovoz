<?xml version="1.0" encoding="UTF-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description></Description>
  <Author></Author>
  <PageHeight>296.926mm</PageHeight>
  <PageWidth>210.058mm</PageWidth>
  <Width>295mm</Width>
  <TopMargin>5mm</TopMargin>
  <LeftMargin>1mm</LeftMargin>
  <RightMargin>1mm</RightMargin>
  <BottomMargin>5mm</BottomMargin>
  <PageHeader>
    <Height>62.7pt</Height>
    <PrintOnFirstPage>true</PrintOnFirstPage>
    <PrintOnLastPage>true</PrintOnLastPage>
    <ReportItems>
      <Textbox Name="Textbox2">
        <Height>21.80pt</Height>
        <Width>476.16pt</Width>
        <Value>="Аналитика недовозов на " + {?title_date}</Value>
        <ZIndex>0</ZIndex>
        <Left>60.4pt</Left>
        <Top>22.9pt</Top>
        <Style>
          <BorderStyle />
          <BorderColor />
          <BorderWidth />
          <FontSize>16pt</FontSize>
          <PaddingTop>0mm</PaddingTop>
          <PaddingLeft>0mm</PaddingLeft>
          <PaddingBottom>0mm</PaddingBottom>
          <PaddingRight>0mm</PaddingRight>
          <TextAlign>Left</TextAlign>
        </Style>
      </Textbox>
    </ReportItems>
  </PageHeader>
  <Body>
    <Height>529.3pt</Height>
    <ReportItems>
      <Table Name="Table2">
        <DataSetName>deliveries_late_Set</DataSetName>
        <NoRows></NoRows>
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
          <BorderColor />
          <BorderWidth />
        </Style>
        <TableColumns>
          <TableColumn>
            <Width>88.9pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>91.1pt</Width>
          </TableColumn>
        </TableColumns>
        <Header>
          <TableRows>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox52">
                      <Value>Опоздания:</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox53">
                      <Value></Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>None</Default>
                          <Left>None</Left>
                          <Right>None</Right>
                          <Top>None</Top>
                          <Bottom>None</Bottom>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox8">
                      <Value>Адреса</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox14">
                      <Value>Минуты</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
        </Header>
        <Left>59.1pt</Left>
        <Top>72.4pt</Top>
        <Footer>
          <TableRows>
            <TableRow>
              <Height>18.4pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox17">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Value>=Iif(Fields!Addresses.IsMissing, 0, Count({Addresses}))</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox18">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Value>=Iif(Fields!Minutes.IsMissing
,0
,
Sum({Minutes})
)</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Footer>
        <Visibility>
          <Hidden></Hidden>
        </Visibility>
      </Table>
      <Table Name="Table1">
        <DataSetName>deliveries_late_Set_2</DataSetName>
        <NoRows></NoRows>
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
          <BorderColor />
          <BorderWidth />
          <BackgroundColor></BackgroundColor>
        </Style>
        <TableColumns>
          <TableColumn>
            <Width>85.0pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>92.1pt</Width>
          </TableColumn>
        </TableColumns>
        <Header>
          <TableRows>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox62">
                      <Value>Опоздания</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox63">
                      <Value></Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>None</Default>
                          <Left>None</Left>
                          <Right>None</Right>
                          <Top>None</Top>
                          <Bottom>None</Bottom>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
            <TableRow>
              <Height>12.8pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox3">
                      <Value>Адреса</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox4">
                      <Value>Минуты</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
        </Header>
        <Left>344.8pt</Left>
        <Top>72.4pt</Top>
        <Footer>
          <TableRows>
            <TableRow>
              <Height>17.6pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox12">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <BackgroundColor>=Iif
(
Count({Addresses},'deliveries_late_Set_2')&gt;Count({Addresses},'deliveries_late_Set')
, 
Red
, 
LightGreen
)</BackgroundColor>
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Value>=Count(Fields!Addresses.Value)
+
' ( '
+Convert.ToInt32
(100*
(
Count(Fields!Addresses.Value)
-
(Count({Addresses},'deliveries_late_Set'))
)
/
(Count({Addresses},'deliveries_late_Set'))
)
+
'%)'</Value>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox13">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <BackgroundColor>=Iif
(
Sum({Minutes},'deliveries_late_Set_2')&gt;Sum({Minutes},'deliveries_late_Set')
, 
Red
, 
LightGreen
)</BackgroundColor>
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Value>=Sum(Fields!Minutes.Value)
+
' ( '
+Convert.ToInt32
(100*
(
Sum(Fields!Minutes.Value)
-
(Sum({Minutes},'deliveries_late_Set'))
)
/
(Sum({Minutes},'deliveries_late_Set'))
)
+
'%)'</Value>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Footer>
      </Table>
      <Table Name="Table5">
        <DataSetName>bottles_addresses_set_2</DataSetName>
        <NoRows></NoRows>
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
          <BorderColor />
          <BorderWidth />
        </Style>
        <TableColumns>
          <TableColumn>
            <Width>86.6pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>91.9pt</Width>
          </TableColumn>
        </TableColumns>
        <Header>
          <TableRows>
            <TableRow>
              <Height>13.5pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox60">
                      <Value>Заказы:</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox61">
                      <Value></Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>None</Default>
                          <Left>None</Left>
                          <Right>None</Right>
                          <Top>None</Top>
                          <Bottom>None</Bottom>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
            <TableRow>
              <Height>13.5pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox7">
                      <Value>Адреса</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox9">
                      <Value>Бутыли</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
        </Header>
        <Left>344.7pt</Left>
        <Top>149.4pt</Top>
        <Footer>
          <TableRows>
            <TableRow>
              <Height>.2in</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox19">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                        <BackgroundColor>=Iif(
{addresses}&lt;
First({addresses},'bottles_addresses_set')
, 
Red, LightGreen)</BackgroundColor>
                      </Style>
                      <Value>={addresses}
+
' ( '
+
Iif(
{addresses}&lt;
First({addresses},'bottles_addresses_set')
, 
' ', '+')
+Convert.ToInt32
(100*
(
{addresses}
-
First({addresses},'bottles_addresses_set')
)
/
First({addresses},'bottles_addresses_set')
)
+
'%)'</Value>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox20">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                        <BackgroundColor>=Iif(
{bottles}&lt;
First({bottles},'bottles_addresses_set')
, 
Red, LightGreen)</BackgroundColor>
                      </Style>
                      <Value>={bottles}
+
' ( '
+
Iif(
{bottles}&lt;
First({bottles},'bottles_addresses_set')
, 
' ', ' +')
+Convert.ToInt32
(100*
(
{bottles}
-
First({bottles},'bottles_addresses_set')
)
/
First({bottles},'bottles_addresses_set')
)
+
'%)'</Value>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Footer>
      </Table>
      <Table Name="Table3">
        <DataSetName>guiltiesSet</DataSetName>
        <NoRows>Query returned no rows!</NoRows>
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
          <BorderColor />
          <BorderWidth />
        </Style>
        <TableColumns>
          <TableColumn>
            <Width>85.8pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>95.4pt</Width>
          </TableColumn>
        </TableColumns>
        <Header>
          <TableRows>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox56">
                      <Value>Список</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Right</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Right>None</Right>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox57">
                      <Value>ответственных:</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Left</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Left>None</Left>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox1">
                      <Value>Ответственный</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox10">
                      <Value>Кол-во</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
        </Header>
        <Details>
          <TableRows>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox11">
                      <Value>=Fields!guiltyboys.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Right>None</Right>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Left</TextAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox22">
                      <Value>=Fields!Quantity.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Left>None</Left>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Justified</TextAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Details>
        <Left>59.0pt</Left>
        <Top>12.2pt</Top>
        <Footer>
          <TableRows>
            <TableRow>
              <Height>.2in</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox23">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Right>None</Right>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <FontWeight>Bold</FontWeight>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Value> Итог по ЛО: </Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox24">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Left>None</Left>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Left</TextAlign>
                      </Style>
                      <Value>=First({Quantity},"LO_Only")</Value>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Footer>
        <Visibility>
          <Hidden></Hidden>
        </Visibility>
      </Table>
      <Table Name="Table6">
        <DataSetName>guiltiesSet2</DataSetName>
        <NoRows>Query returned no rows!</NoRows>
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
          <BorderColor />
          <BorderWidth />
        </Style>
        <TableColumns>
          <TableColumn>
            <Width>86.6pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>91.4pt</Width>
          </TableColumn>
        </TableColumns>
        <Header>
          <TableRows>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox58">
                      <Value>Список</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Right</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Right>None</Right>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox59">
                      <Value>Ответственных:</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Left</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Left>None</Left>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox25">
                      <Value>ответственный</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox27">
                      <Value>Кол-во</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
        </Header>
        <Details>
          <TableRows>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox29">
                      <Value>=Fields!guiltyboys.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Right>None</Right>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Left</TextAlign>
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox30">
                      <Value>=Fields!Quantity.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Left>None</Left>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Left</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Details>
        <Left>344.1pt</Left>
        <Top>12.2pt</Top>
        <Footer>
          <TableRows>
            <TableRow>
              <Height>.2in</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox31">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Right>None</Right>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <FontWeight>Bold</FontWeight>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Value> Итог по ЛО:</Value>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox32">
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Left>None</Left>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <BackgroundColor>=Iif(
First({Quantity},"LO_Only")&gt;Last({Quantity},"LO_Only")
,
LightGreen
,
Red) </BackgroundColor>
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Value>=Last({Quantity},'LO_Only')
+
" ("
+
Iif
(
First({Quantity},'LO_Only')&lt;Last({Quantity},'LO_Only')
, 
" +"
, 
" "
)
+
Convert.ToInt32((
(100*(Last({Quantity},'LO_Only')-First({Quantity},'LO_Only')))
/First({Quantity},'LO_Only')
))
+
"%)"</Value>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
        </Footer>
      </Table>
      <fyi:Grid xmlns:fyi="http://www.fyireporting.com/schemas" Name="Grid1">
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
          <BorderColor />
          <BorderWidth />
        </Style>
        <TableColumns>
          <TableColumn>
            <Width>103.0pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>76.0pt</Width>
          </TableColumn>
        </TableColumns>
        <Header>
          <TableRows>
            <TableRow>
              <Height>12.8pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox5">
                      <Value>Итого недовезено:</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Right>None</Right>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox15">
                      <Value></Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Left>None</Left>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
        </Header>
        <Details>
          <TableRows>
            <TableRow>
              <Height>14.4pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox16">
                      <Value>Заказов:</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox36">
                      <Value>=First({orders_count},'undeliveried_orders1')</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Left</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
            <TableRow>
              <Height>16.8pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox28">
                      <Value>Воды 19л:</Value>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox41">
                      <Value>=Convert.ToInt32(First({bottles_count},'undeliveried_bottles1'))</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Left</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Details>
        <Left>59.7pt</Left>
        <Top>193.7pt</Top>
        <Visibility>
          <Hidden></Hidden>
          <ToggleItem></ToggleItem>
        </Visibility>
      </fyi:Grid>
      <fyi:Grid xmlns:fyi="http://www.fyireporting.com/schemas" Name="Grid3">
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
          <BorderColor />
          <BorderWidth />
        </Style>
        <TableColumns>
          <TableColumn>
            <Width>97.3pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>81.1pt</Width>
          </TableColumn>
        </TableColumns>
        <Header>
          <TableRows>
            <TableRow>
              <Height>12.8pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox37">
                      <Value>Итого недовезено:</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Right>None</Right>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox39">
                      <Value></Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Left>None</Left>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
        </Header>
        <Details>
          <TableRows>
            <TableRow>
              <Height>15.3pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox40">
                      <Value>Заказов:</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox42">
                      <Value>=First({orders_count},'undeliveried_orders2') +' (' 
+
Iif(First({orders_count},'undeliveried_orders1')&gt;First({orders_count},'undeliveried_orders2'),' ','+')
+Convert.ToInt32((100*
((First({orders_count},'undeliveried_orders2')-First({orders_count},'undeliveried_orders1'))/First({orders_count},'undeliveried_orders1'))
))+
'%)'</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <BackgroundColor>=Iif(
First({orders_count},'undeliveried_orders2')&gt;First({orders_count},'undeliveried_orders1')
, 
Red
, 
LightGreen
)
</BackgroundColor>
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
            <TableRow>
              <Height>15.2pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox43">
                      <Value>Воды 19л:</Value>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox44">
                      <Value>=Convert.ToInt32
(First({bottles_count},'undeliveried_bottles2')) +' (' 
+
Iif(First({bottles_count},'undeliveried_bottles1')&gt;First({bottles_count},'undeliveried_bottles2'),' ','+')
+Convert.ToInt32((100*
((First({bottles_count},'undeliveried_bottles2')-First({bottles_count},'undeliveried_bottles1'))/First({bottles_count},'undeliveried_bottles1'))
))+
'%)'</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <BackgroundColor>=Iif(
First({bottles_count},'undeliveried_bottles2')&gt;First({bottles_count},'undeliveried_bottles1')
, 
Red
, 
LightGreen
)</BackgroundColor>
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Details>
        <Left>344.5pt</Left>
        <Top>192.6pt</Top>
      </fyi:Grid>
      <Table Name="Table4">
        <DataSetName>bottles_addresses_set</DataSetName>
        <NoRows></NoRows>
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
          <BorderColor />
          <BorderWidth />
        </Style>
        <TableColumns>
          <TableColumn>
            <Width>85.8pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>93.3pt</Width>
          </TableColumn>
        </TableColumns>
        <Header>
          <TableRows>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox48">
                      <Value>Заказы:</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                          <Right>Solid</Right>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox49">
                      <Value></Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>None</Default>
                          <Left>None</Left>
                          <Right>None</Right>
                          <Top>None</Top>
                          <Bottom>None</Bottom>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
            <TableRow>
              <Height>12.8pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox6">
                      <Value>Адреса</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox21">
                      <Value>Бутыли</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
        </Header>
        <Details>
          <TableRows>
            <TableRow>
              <Height>15.1pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox54">
                      <Value>={addresses}</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox55">
                      <Value>={bottles}</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Details>
        <Left>59.6pt</Left>
        <Top>151.3pt</Top>
      </Table>
      <Table Name="Table7">
        <DataSetName>geopart_divided</DataSetName>
        <NoRows></NoRows>
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
          <BorderColor />
          <BorderWidth />
        </Style>
        <TableColumns>
          <TableColumn>
            <Width>88.5pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>90.5pt</Width>
          </TableColumn>
        </TableColumns>
        <Header>
          <TableRows>
            <TableRow>
              <Height>14.3pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox50">
                      <Value>По складам:</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox51">
                      <Value></Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>None</Default>
                          <Left>None</Left>
                          <Right>None</Right>
                          <Top>None</Top>
                          <Bottom>None</Bottom>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
        </Header>
        <Details>
          <TableRows>
            <TableRow>
              <Height>17.6pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox34">
                      <Value>=Fields!Addresses.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox35">
                      <Value>=Fields!Minutes.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Details>
        <Left>59.4pt</Left>
        <Top>114.8pt</Top>
      </Table>
      <Table Name="Table8">
        <DataSetName>geopart_divided2</DataSetName>
        <NoRows></NoRows>
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
          <BorderColor />
          <BorderWidth />
        </Style>
        <TableColumns>
          <TableColumn>
            <Width>85.0pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>92.2pt</Width>
          </TableColumn>
        </TableColumns>
        <Header>
          <TableRows>
            <TableRow>
              <Height>14.4pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox64">
                      <Value>По складам:</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox65">
                      <Value></Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>None</Default>
                          <Left>None</Left>
                          <Right>None</Right>
                          <Top>None</Top>
                          <Bottom>None</Bottom>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
        </Header>
        <Details>
          <TableRows>
            <TableRow>
              <Height>16.0pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox46">
                      <Value>=Fields!Addresses.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox47">
                      <Value>=Fields!Minutes.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                        <VerticalAlign>Middle</VerticalAlign>
                      </Style>
                      <Visibility>
                        <Hidden>=Iif({?first_date} = {?second_date}, true, false)</Hidden>
                      </Visibility>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Details>
        <Left>344.9pt</Left>
        <Top>114.8pt</Top>
      </Table>
    </ReportItems>
    <Columns>1</Columns>
  </Body>
  <PageFooter>
    <Height>15.5pt</Height>
    <PrintOnFirstPage>true</PrintOnFirstPage>
    <PrintOnLastPage>true</PrintOnLastPage>
  </PageFooter>
  <DataSets>
    <DataSet Name="guiltiesSet">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>select
  CONCAT(
               case 
                   when guilty.guilty_side = 'Department' 
                       THEN IFNULL(CONCAT('Отд: ', sd.short_name),'Отдел ВВ')
                   when guilty.guilty_side = 'Client' THEN 'Клиент'
                   when guilty.guilty_side = 'Driver' then 'Водитель'
                   when guilty.guilty_side = 'ServiceMan' then 'Мастер СЦ'
                   when guilty.guilty_side = 'ForceMajor' then 'Форс-мажор'
                   when guilty.guilty_side = 'DirectorLO' then 'Доставка за час'
                   when guilty.guilty_side = 'DirectorLOCurrentDayDelivery' then 'Довезли в тот же день' 
                   when guilty.guilty_side = 'AutoСancelAutoTransfer' then 'Автоотмена автопереноса'
                   when guilty.guilty_side = 'None' then 'Нет (не недовоз)'
                   else guilty.guilty_side
                   end
           ) as guiltyboys,
       count(und.id) as Quantity
from undelivered_orders as und
         left join orders as ord on und.old_order_id = ord.id
         left join guilty_in_undelivered_orders as guilty on guilty.undelivery_id = und.id
         left join subdivisions as sd on sd.id = guilty.guilty_department_id
where ord.delivery_date = @first_date 
group by case 
    when guilty.guilty_side = 'Department' then sd.short_name
    else guilty.guilty_side
end      </CommandText>
        <QueryParameters>
          <QueryParameter Name="first_date">
            <Value>=Parameters!first_date</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="guiltyboys">
          <DataField>guiltyboys</DataField>
          <TypeName>System.String</TypeName>
        </Field>
        <Field Name="Quantity">
          <DataField>Quantity</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="deliveries_late_Set">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>select Result.Addresses as Addresses, CAST(Result.Minutes AS INT) as Minutes from (
                  SELECT
                      IFNULL(orders.time_delivered,
                             route_list_addresses.status_last_update) AS Addresses,
                      TIMEDIFF(TIME(IFNULL(orders.time_delivered,
                                           route_list_addresses.status_last_update)),
                               delivery_schedule.to_time) AS delay,
                      (TIMESTAMPDIFF(SECOND,delivery_schedule.to_time,TIME(IFNULL(orders.time_delivered,
                                                                                  route_list_addresses.status_last_update))
                           )/60) AS Minutes
                  FROM
                      route_lists
                          LEFT JOIN employees ON employees.id = route_lists.driver_id
                          LEFT JOIN route_list_addresses ON route_list_addresses.route_list_id = route_lists.id
                          LEFT JOIN orders ON orders.id = route_list_addresses.order_id
                          LEFT JOIN counterparty ON counterparty.id = orders.client_id
                          LEFT JOIN delivery_points ON delivery_points.id = orders.delivery_point_id
                          LEFT JOIN delivery_schedule ON delivery_schedule.id = orders.delivery_schedule_id
                          LEFT JOIN late_arrival_reasons lar on route_list_addresses.late_arrival_reason_id = lar.id
                          LEFT JOIN employees lo_comment_author ON lo_comment_author.id = route_list_addresses.comment_for_fine_author_id
                          LEFT OUTER JOIN fines_to_route_list_addresses fine_route_list_adrs on route_list_addresses.id = fine_route_list_adrs.route_list_address_id
                          LEFT OUTER JOIN fines fine on fine_route_list_adrs.fine_id = fine.id
                          LEFT JOIN districts ON delivery_points.district_id = districts.id
                  WHERE
                          route_lists.`date` = @first_date
                    AND route_list_addresses.status = 'Completed'
                    AND employees.visiting_master = 0
                  GROUP BY route_list_addresses.id
                  HAVING delay &gt; 0
                  ) as Result</CommandText>
        <QueryParameters>
          <QueryParameter Name="first_date">
            <Value>=Parameters!first_date</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="Addresses">
          <DataField>Addresses</DataField>
          <TypeName>System.DateTime</TypeName>
        </Field>
        <Field Name="Minutes">
          <DataField>Minutes</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="bottles_addresses_set">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <Timeout>180</Timeout>
        <CommandText>SELECT
(
        if(CAST(SUM(T.bottles_monday) as SIGNED) is null,0,CAST(SUM(T.bottles_monday) as SIGNED)) +
        if(CAST(SUM(T.bottles_tuesday) as SIGNED) is null,0,CAST(SUM(T.bottles_tuesday) as SIGNED)) +
        if(CAST(SUM(T.bottles_wednesday) as SIGNED) is null,0,CAST(SUM(T.bottles_wednesday) as SIGNED)) +
        if(CAST(SUM(T.bottles_thursday) as SIGNED) is null,0,CAST(SUM(T.bottles_thursday) as SIGNED)) +
        if(CAST(SUM(T.bottles_friday) as SIGNED) is null,0,CAST(SUM(T.bottles_friday) as SIGNED)) +
        if(CAST(SUM(T.bottles_saturday) as SIGNED) is null,0,CAST(SUM(T.bottles_saturday) as SIGNED)) +
        if(CAST(SUM(T.bottles_sunday) as SIGNED) is null,0,CAST(SUM(T.bottles_sunday) as SIGNED))
        ) as bottles,
    (
            if((COUNT(T.address_monday) * (SUM(T.address_monday) - SUM(T.address_monday) + 1) ) is null,
                0,(COUNT(T.address_monday) * (SUM(T.address_monday) - SUM(T.address_monday) + 1) )) +
            if((COUNT(T.address_tuesday) * (SUM(T.address_tuesday) - SUM(T.address_tuesday) + 1) ) is null,
                0,(COUNT(T.address_tuesday) * (SUM(T.address_tuesday) - SUM(T.address_tuesday) + 1) )) +
            if((COUNT(T.address_wednesday) * (SUM(T.address_wednesday) - SUM(T.address_wednesday) + 1) ) is null,
                0,    (COUNT(T.address_wednesday) * (SUM(T.address_wednesday) - SUM(T.address_wednesday) + 1) )) +
            if((COUNT(T.address_thursday) * (SUM(T.address_thursday) - SUM(T.address_thursday) + 1) ) is null,
                0,(COUNT(T.address_thursday) * (SUM(T.address_thursday) - SUM(T.address_thursday) + 1) )) +
            if((COUNT(T.address_friday) * (SUM(T.address_friday) - SUM(T.address_friday) + 1) ) is null,
                0,(COUNT(T.address_friday) * (SUM(T.address_friday) - SUM(T.address_friday) + 1) )) +
            if((COUNT(T.address_saturday) * (SUM(T.address_saturday) - SUM(T.address_saturday) + 1) ) is null,
                0,(COUNT(T.address_saturday) * (SUM(T.address_saturday) - SUM(T.address_saturday) + 1) )) +
            if((COUNT(T.address_sunday) * (SUM(T.address_sunday) - SUM(T.address_sunday) + 1) ) is null,
                0,(COUNT(T.address_sunday) * (SUM(T.address_sunday) - SUM(T.address_sunday) + 1) ))
        ) as addresses
FROM
    (SELECT
         week_days.week_begin,
         week_days.week_end,

         IF(dayofweek = 0, order_sum.count, null)  AS bottles_monday,
         IF(dayofweek = 0, compiled_address, null)  AS address_monday,

         IF(dayofweek = 1 , order_sum.count, null)  AS bottles_tuesday,
         IF(dayofweek = 1 , compiled_address, null)  AS address_tuesday,

         IF(dayofweek = 2 , order_sum.count, null)  AS bottles_wednesday,
         IF(dayofweek = 2 , compiled_address, null)  AS address_wednesday,

         IF(dayofweek = 3 , order_sum.count, null)  AS bottles_thursday,
         IF(dayofweek = 3 , compiled_address, null)  AS address_thursday,

         IF(dayofweek = 4 , order_sum.count, null)  AS bottles_friday,
         IF(dayofweek = 4 , compiled_address, null)  AS address_friday,

         IF(dayofweek = 5 , order_sum.count, null)  AS bottles_saturday,
         IF(dayofweek = 5 , compiled_address, null)  AS address_saturday,

         IF(dayofweek = 6 , order_sum.count, null)  AS bottles_sunday,
         IF(dayofweek = 6 , compiled_address, null)  AS address_sunday
     FROM
         orders
             LEFT JOIN
         (
             SELECT
                 orders.id as order_id,
                 date_sub(delivery_date, interval (weekday(delivery_date)) day) as week_begin,
                 date_add(delivery_date, interval (6-weekday(delivery_date)) day) as week_end,
                 WEEKDAY(delivery_date) as dayofweek
             FROM
                 orders
                     LEFT JOIN
                 delivery_schedule ON delivery_schedule.id = orders.delivery_schedule_id
         ) as week_days ON week_days.order_id = orders.id
             LEFT JOIN
         (
             SELECT
                 order_items.order_id,
                 SUM(order_items.count) AS count
             FROM
                 order_items
                     LEFT JOIN
                 nomenclature ON order_items.nomenclature_id = nomenclature.id
             WHERE
                     nomenclature.category = 'water' AND nomenclature.tare_volume = 'Vol19L'
             GROUP BY order_items.order_id
         ) AS order_sum ON order_sum.order_id = orders.id
             INNER JOIN
         delivery_points ON delivery_point_id = delivery_points.id
             INNER JOIN
         delivery_schedule ON delivery_schedule.id = orders.delivery_schedule_id
             LEFT JOIN
        districts ON delivery_points.district_id = districts.id
            LEFT JOIN
        geo_groups ON geo_groups.id = districts.geo_group_id
     WHERE orders.delivery_date = @first_date
       AND orders.order_status NOT IN ('Canceled', 'NewOrder', 'WaitForPayment', 'DeliveryCanceled', 'NotDelivered')
       AND !orders.self_delivery
       AND !orders.is_contract_closer
       AND orders.order_address_type != 'Service'
       AND geo_groups.id in (@geoparts)) as T</CommandText>
        <QueryParameters>
          <QueryParameter Name="first_date">
            <Value>=Parameters!first_date</Value>
          </QueryParameter>
          <QueryParameter Name="geoparts">
            <Value>=Parameters!geoparts</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="bottles">
          <DataField>bottles</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
        <Field Name="addresses">
          <DataField>addresses</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="deliveries_late_Set_2">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>select Result.Addresses as Addresses, CAST(Result.Minutes AS INT) as Minutes from (
                  SELECT
                      IFNULL(orders.time_delivered,
                             route_list_addresses.status_last_update) AS Addresses,
                      TIMEDIFF(TIME(IFNULL(orders.time_delivered,
                                           route_list_addresses.status_last_update)),
                               delivery_schedule.to_time) AS delay,
                      (TIMESTAMPDIFF(SECOND,delivery_schedule.to_time,TIME(IFNULL(orders.time_delivered,
                                                                                  route_list_addresses.status_last_update))
                           )/60) AS Minutes
                  FROM
                      route_lists
                          LEFT JOIN employees ON employees.id = route_lists.driver_id
                          LEFT JOIN route_list_addresses ON route_list_addresses.route_list_id = route_lists.id
                          LEFT JOIN orders ON orders.id = route_list_addresses.order_id
                          LEFT JOIN counterparty ON counterparty.id = orders.client_id
                          LEFT JOIN delivery_points ON delivery_points.id = orders.delivery_point_id
                          LEFT JOIN delivery_schedule ON delivery_schedule.id = orders.delivery_schedule_id
                          LEFT JOIN late_arrival_reasons lar on route_list_addresses.late_arrival_reason_id = lar.id
                          LEFT JOIN employees lo_comment_author ON lo_comment_author.id = route_list_addresses.comment_for_fine_author_id
                          LEFT OUTER JOIN fines_to_route_list_addresses fine_route_list_adrs on route_list_addresses.id = fine_route_list_adrs.route_list_address_id
                          LEFT OUTER JOIN fines fine on fine_route_list_adrs.fine_id = fine.id
                          LEFT JOIN districts ON delivery_points.district_id = districts.id
                  WHERE
                          route_lists.`date` = @second_date
                    AND route_list_addresses.status = 'Completed'
                    AND employees.visiting_master = 0
                  GROUP BY route_list_addresses.id
                  HAVING delay &gt; 0
                  ) as Result</CommandText>
        <QueryParameters>
          <QueryParameter Name="second_date">
            <Value>=Parameters!second_date</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="Addresses">
          <DataField>Addresses</DataField>
          <TypeName>System.DateTime</TypeName>
        </Field>
        <Field Name="Minutes">
          <DataField>Minutes</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="bottles_addresses_set_2">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <Timeout>180</Timeout>
        <CommandText>SELECT
    (
        if(CAST(SUM(T.bottles_monday) as SIGNED) is null,0,CAST(SUM(T.bottles_monday) as SIGNED)) +
        if(CAST(SUM(T.bottles_tuesday) as SIGNED) is null,0,CAST(SUM(T.bottles_tuesday) as SIGNED)) +
        if(CAST(SUM(T.bottles_wednesday) as SIGNED) is null,0,CAST(SUM(T.bottles_wednesday) as SIGNED)) +
        if(CAST(SUM(T.bottles_thursday) as SIGNED) is null,0,CAST(SUM(T.bottles_thursday) as SIGNED)) +
        if(CAST(SUM(T.bottles_friday) as SIGNED) is null,0,CAST(SUM(T.bottles_friday) as SIGNED)) +
        if(CAST(SUM(T.bottles_saturday) as SIGNED) is null,0,CAST(SUM(T.bottles_saturday) as SIGNED)) +
        if(CAST(SUM(T.bottles_sunday) as SIGNED) is null,0,CAST(SUM(T.bottles_sunday) as SIGNED))
        ) as bottles,
    (
            if((COUNT(T.address_monday) * (SUM(T.address_monday) - SUM(T.address_monday) + 1) ) is null,
                0,(COUNT(T.address_monday) * (SUM(T.address_monday) - SUM(T.address_monday) + 1) )) +
            if((COUNT(T.address_tuesday) * (SUM(T.address_tuesday) - SUM(T.address_tuesday) + 1) ) is null,
                0,(COUNT(T.address_tuesday) * (SUM(T.address_tuesday) - SUM(T.address_tuesday) + 1) )) +
            if((COUNT(T.address_wednesday) * (SUM(T.address_wednesday) - SUM(T.address_wednesday) + 1) ) is null,
                0,    (COUNT(T.address_wednesday) * (SUM(T.address_wednesday) - SUM(T.address_wednesday) + 1) )) +
            if((COUNT(T.address_thursday) * (SUM(T.address_thursday) - SUM(T.address_thursday) + 1) ) is null,
                0,(COUNT(T.address_thursday) * (SUM(T.address_thursday) - SUM(T.address_thursday) + 1) )) +
            if((COUNT(T.address_friday) * (SUM(T.address_friday) - SUM(T.address_friday) + 1) ) is null,
                0,(COUNT(T.address_friday) * (SUM(T.address_friday) - SUM(T.address_friday) + 1) )) +
            if((COUNT(T.address_saturday) * (SUM(T.address_saturday) - SUM(T.address_saturday) + 1) ) is null,
                0,(COUNT(T.address_saturday) * (SUM(T.address_saturday) - SUM(T.address_saturday) + 1) )) +
            if((COUNT(T.address_sunday) * (SUM(T.address_sunday) - SUM(T.address_sunday) + 1) ) is null,
                0,(COUNT(T.address_sunday) * (SUM(T.address_sunday) - SUM(T.address_sunday) + 1) ))
        ) as addresses
FROM
    (SELECT
         week_days.week_begin,
         week_days.week_end,

         IF(dayofweek = 0, order_sum.count, null)  AS bottles_monday,
         IF(dayofweek = 0, compiled_address, null)  AS address_monday,

         IF(dayofweek = 1 , order_sum.count, null)  AS bottles_tuesday,
         IF(dayofweek = 1 , compiled_address, null)  AS address_tuesday,

         IF(dayofweek = 2 , order_sum.count, null)  AS bottles_wednesday,
         IF(dayofweek = 2 , compiled_address, null)  AS address_wednesday,

         IF(dayofweek = 3 , order_sum.count, null)  AS bottles_thursday,
         IF(dayofweek = 3 , compiled_address, null)  AS address_thursday,

         IF(dayofweek = 4 , order_sum.count, null)  AS bottles_friday,
         IF(dayofweek = 4 , compiled_address, null)  AS address_friday,

         IF(dayofweek = 5 , order_sum.count, null)  AS bottles_saturday,
         IF(dayofweek = 5 , compiled_address, null)  AS address_saturday,

         IF(dayofweek = 6 , order_sum.count, null)  AS bottles_sunday,
         IF(dayofweek = 6 , compiled_address, null)  AS address_sunday
     FROM
         orders
             LEFT JOIN
         (
             SELECT
                 orders.id as order_id,
                 date_sub(delivery_date, interval (weekday(delivery_date)) day) as week_begin,
                 date_add(delivery_date, interval (6-weekday(delivery_date)) day) as week_end,
                 WEEKDAY(delivery_date) as dayofweek
             FROM
                 orders
                     LEFT JOIN
                 delivery_schedule ON delivery_schedule.id = orders.delivery_schedule_id
         ) as week_days ON week_days.order_id = orders.id
             LEFT JOIN
         (
             SELECT
                 order_items.order_id,
                 SUM(order_items.count) AS count
             FROM
                 order_items
                     LEFT JOIN
                 nomenclature ON order_items.nomenclature_id = nomenclature.id
             WHERE
                     nomenclature.category = 'water' AND nomenclature.tare_volume = 'Vol19L'
             GROUP BY order_items.order_id
         ) AS order_sum ON order_sum.order_id = orders.id
             INNER JOIN
         delivery_points ON delivery_point_id = delivery_points.id
             INNER JOIN
         delivery_schedule ON delivery_schedule.id = orders.delivery_schedule_id
             LEFT JOIN
        districts ON delivery_points.district_id = districts.id
            LEFT JOIN
        geo_groups ON geo_groups.id = districts.geo_group_id
     WHERE
       orders.delivery_date = @second_date
       AND orders.order_status NOT IN ('Canceled', 'NewOrder', 'WaitForPayment', 'DeliveryCanceled', 'NotDelivered')
       AND !orders.self_delivery
       AND !orders.is_contract_closer
       AND orders.order_address_type != 'Service'
       AND geo_groups.id in (@geoparts)) as T</CommandText>
        <QueryParameters>
          <QueryParameter Name="second_date">
            <Value>=Parameters!second_date</Value>
          </QueryParameter>
          <QueryParameter Name="geoparts">
            <Value>=Parameters!geoparts</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="bottles">
          <DataField>bottles</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
        <Field Name="addresses">
          <DataField>addresses</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="guiltiesSet2">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>select
  CONCAT(
               case 
                   when guilty.guilty_side = 'Department' 
                       THEN IFNULL(CONCAT('Отд: ', sd.short_name),'Отдел ВВ')
                   when guilty.guilty_side = 'Client' THEN 'Клиент'
                   when guilty.guilty_side = 'Driver' then 'Водитель'
                   when guilty.guilty_side = 'ServiceMan' then 'Мастер СЦ'
                   when guilty.guilty_side = 'ForceMajor' then 'Форс-мажор'
                   when guilty.guilty_side = 'DirectorLO' then 'Доставка за час'
                   when guilty.guilty_side = 'DirectorLOCurrentDayDelivery' then 'Довезли в тот же день' 
                   when guilty.guilty_side = 'AutoСancelAutoTransfer' then 'Автоотмена автопереноса'
                   when guilty.guilty_side = 'None' then 'Нет (не недовоз)'
                   else guilty.guilty_side
                   end
           ) as guiltyboys,
       count(und.id) as Quantity
from undelivered_orders as und
         left join orders as ord on und.old_order_id = ord.id
         left join guilty_in_undelivered_orders as guilty on guilty.undelivery_id = und.id
         left join subdivisions as sd on sd.id = guilty.guilty_department_id
where ord.delivery_date = @second_date 
group by case 
    when guilty.guilty_side = 'Department' then sd.short_name
    else guilty.guilty_side
             end </CommandText>
        <QueryParameters>
          <QueryParameter Name="second_date">
            <Value>=Parameters!second_date</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="guiltyboys">
          <DataField>guiltyboys</DataField>
          <TypeName>System.String</TypeName>
        </Field>
        <Field Name="Quantity">
          <DataField>Quantity</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="undeliveried_bottles1">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>select sum(oi.count) as bottles_count from undelivered_orders u 
    inner join orders o on u.old_order_id = o.id
    left join order_items oi on o.id = oi.order_id and u.old_order_id = oi.order_id
    left join (select n.id, n.tare_volume, n.category from nomenclature n where n.category = 'water' and n.tare_volume = 'Vol19L') nm
on oi.nomenclature_id = nm.id
where o.delivery_date = @first_date and nm.category is not null and nm.tare_volume is not null</CommandText>
        <QueryParameters>
          <QueryParameter Name="first_date">
            <Value>=Parameters!first_date</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="bottles_count">
          <DataField>bottles_count</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="undeliveried_orders1">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>select count(u.id) as orders_count from undelivered_orders u 
    left join orders o on u.old_order_id = o.id
where o.delivery_date = @first_date</CommandText>
        <QueryParameters>
          <QueryParameter Name="first_date">
            <Value>=Parameters!first_date</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="orders_count">
          <DataField>orders_count</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="undeliveried_bottles2">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>select sum(oi.count) as bottles_count from undelivered_orders u 
    inner join orders o on u.old_order_id = o.id
    left join order_items oi on o.id = oi.order_id and u.old_order_id = oi.order_id
    left join (select n.id, n.tare_volume, n.category from nomenclature n where n.category = 'water' and n.tare_volume = 'Vol19L') nm
on oi.nomenclature_id = nm.id
where o.delivery_date = @second_date and nm.category is not null and nm.tare_volume is not null</CommandText>
        <QueryParameters>
          <QueryParameter Name="second_date">
            <Value>=Parameters!second_date</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="bottles_count">
          <DataField>bottles_count</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="undeliveried_orders2">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>select count(u.id) as orders_count from undelivered_orders u 
    left join orders o on u.old_order_id = o.id
where o.delivery_date = @second_date</CommandText>
        <QueryParameters>
          <QueryParameter Name="second_date">
            <Value>=Parameters!second_date</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="orders_count">
          <DataField>orders_count</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="LO_Only">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>select
    count(und.id) as Quantity
from undelivered_orders as und
         left join orders as ord on und.old_order_id = ord.id
         left join guilty_in_undelivered_orders as guilty on guilty.undelivery_id = und.id
         left join subdivisions as sd on sd.id = guilty.guilty_department_id
where ord.delivery_date = @first_date and
    (
                sd.id = 46 or sd.id = 13 or sd.id = 26
        )
union (
    select
        count(und.id) as Quantity
    from undelivered_orders as und
             left join orders as ord on und.old_order_id = ord.id
             left join guilty_in_undelivered_orders as guilty on guilty.undelivery_id = und.id
             left join subdivisions as sd on sd.id = guilty.guilty_department_id
    where ord.delivery_date = @second_date and
        (
                    sd.id = 46 or sd.id = 13 or sd.id = 26
            )
)</CommandText>
        <QueryParameters>
          <QueryParameter Name="first_date">
            <Value>=Parameters!first_date.Value</Value>
          </QueryParameter>
          <QueryParameter Name="second_date">
            <Value>=Parameters!second_date.Value</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="Quantity">
          <DataField>Quantity</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="geopart_divided">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>select
       concat('Адреса ', g.name, ' ', count(a.delivered_time)) as Addresses,
       concat('Минуты ',g.name, ' ', cast(sum(a.delay2)as int)) as Minutes
from
(SELECT 
       districts.geo_group_id,
    IFNULL(orders.time_delivered,
           route_list_addresses.status_last_update) AS delivered_time,
    TIMEDIFF(TIME(IFNULL(orders.time_delivered,
                         route_list_addresses.status_last_update)),
             delivery_schedule.to_time) AS delay,
       (TIMESTAMPDIFF(SECOND,delivery_schedule.to_time,TIME(IFNULL(orders.time_delivered,
                            route_list_addresses.status_last_update))
                )/60) AS delay2
FROM
    route_lists
        LEFT JOIN employees ON employees.id = route_lists.driver_id
        LEFT JOIN route_list_addresses ON route_list_addresses.route_list_id = route_lists.id
        LEFT JOIN orders ON orders.id = route_list_addresses.order_id
        LEFT JOIN counterparty ON counterparty.id = orders.client_id
        LEFT JOIN delivery_points ON delivery_points.id = orders.delivery_point_id
        LEFT JOIN delivery_schedule ON delivery_schedule.id = orders.delivery_schedule_id
        LEFT JOIN late_arrival_reasons lar on route_list_addresses.late_arrival_reason_id = lar.id
        LEFT JOIN employees lo_comment_author ON lo_comment_author.id = route_list_addresses.comment_for_fine_author_id
        LEFT OUTER JOIN fines_to_route_list_addresses fine_route_list_adrs on route_list_addresses.id = fine_route_list_adrs.route_list_address_id
        LEFT OUTER JOIN fines fine on fine_route_list_adrs.fine_id = fine.id
        LEFT JOIN districts ON delivery_points.district_id = districts.id
WHERE
    route_lists.`date` = @first_date
  AND route_list_addresses.status = 'Completed'
  AND employees.visiting_master = 0
  AND districts.geo_group_id in (@geoparts)
GROUP BY route_list_addresses.id
HAVING delay &gt; 0) as a
left join geo_groups g on g.id = a.geo_group_id
group by a.geo_group_id</CommandText>
        <QueryParameters>
          <QueryParameter Name="geoparts">
            <Value>=Parameters!geoparts</Value>
          </QueryParameter>
          <QueryParameter Name="first_date">
            <Value>=Parameters!first_date</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="Addresses">
          <DataField>Addresses</DataField>
          <TypeName>System.String</TypeName>
        </Field>
        <Field Name="Minutes">
          <DataField>Minutes</DataField>
          <TypeName>System.String</TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="geopart_divided2">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>select
       concat('Адреса ', g.name, ' ', count(a.delivered_time)) as Addresses,
       concat('Минуты ',g.name, ' ', cast(sum(a.delay2)as int)) as Minutes
from
(SELECT 
       districts.geo_group_id,
    IFNULL(orders.time_delivered,
           route_list_addresses.status_last_update) AS delivered_time,
    TIMEDIFF(TIME(IFNULL(orders.time_delivered,
                         route_list_addresses.status_last_update)),
             delivery_schedule.to_time) AS delay,
       (TIMESTAMPDIFF(SECOND,delivery_schedule.to_time,TIME(IFNULL(orders.time_delivered,
                            route_list_addresses.status_last_update))
                )/60) AS delay2
FROM
    route_lists
        LEFT JOIN employees ON employees.id = route_lists.driver_id
        LEFT JOIN route_list_addresses ON route_list_addresses.route_list_id = route_lists.id
        LEFT JOIN orders ON orders.id = route_list_addresses.order_id
        LEFT JOIN counterparty ON counterparty.id = orders.client_id
        LEFT JOIN delivery_points ON delivery_points.id = orders.delivery_point_id
        LEFT JOIN delivery_schedule ON delivery_schedule.id = orders.delivery_schedule_id
        LEFT JOIN late_arrival_reasons lar on route_list_addresses.late_arrival_reason_id = lar.id
        LEFT JOIN employees lo_comment_author ON lo_comment_author.id = route_list_addresses.comment_for_fine_author_id
        LEFT OUTER JOIN fines_to_route_list_addresses fine_route_list_adrs on route_list_addresses.id = fine_route_list_adrs.route_list_address_id
        LEFT OUTER JOIN fines fine on fine_route_list_adrs.fine_id = fine.id
        LEFT JOIN districts ON delivery_points.district_id = districts.id
WHERE
    route_lists.`date` = @second_date
  AND route_list_addresses.status = 'Completed'
  AND employees.visiting_master = 0
  AND districts.geo_group_id in (@geoparts)
GROUP BY route_list_addresses.id
HAVING delay &gt; 0) as a
left join geo_groups g on g.id = a.geo_group_id
group by a.geo_group_id</CommandText>
        <QueryParameters>
          <QueryParameter Name="geoparts">
            <Value>=Parameters!geoparts</Value>
          </QueryParameter>
          <QueryParameter Name="second_date">
            <Value>=Parameters!second_date</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="Addresses">
          <DataField>Addresses</DataField>
          <TypeName>System.String</TypeName>
        </Field>
        <Field Name="Minutes">
          <DataField>Minutes</DataField>
          <TypeName>System.String</TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <DataElementName>Report</DataElementName>
  <DataElementStyle>AttributeNormal</DataElementStyle>
  <DataSources>
    <DataSource Name="DS1">
      <ConnectionProperties>
        <DataProvider>MySqlConnector</DataProvider>
        <ConnectString>database=Vodovoz_test;user=enzogord;password=qwerty;port=3306;server=vod.qsolution.ru</ConnectString>
        <IntegratedSecurity>false</IntegratedSecurity>
      </ConnectionProperties>
    </DataSource>
  </DataSources>
  <ReportParameters>
    <ReportParameter Name="first_date">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>2018-01-01</Value>
        </Values>
      </DefaultValue>
      <Nullable>false</Nullable>
      <AllowBlank>false</AllowBlank>
      <MultiValue>false</MultiValue>
      <Prompt></Prompt>
    </ReportParameter>
    <ReportParameter Name="second_date">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>2018-04-20</Value>
        </Values>
      </DefaultValue>
      <Nullable>false</Nullable>
      <AllowBlank>false</AllowBlank>
      <MultiValue>false</MultiValue>
      <Prompt></Prompt>
    </ReportParameter>
    <ReportParameter Name="title_date">
      <DataType>String</DataType>
      <Nullable>false</Nullable>
      <AllowBlank>false</AllowBlank>
      <MultiValue>false</MultiValue>
      <Prompt></Prompt>
    </ReportParameter>
    <ReportParameter Name="geoparts">
      <DataType>Integer</DataType>
      <Nullable>true</Nullable>
      <AllowBlank>false</AllowBlank>
      <MultiValue>true</MultiValue>
      <Prompt></Prompt>
    </ReportParameter>
  </ReportParameters>
</Report>
